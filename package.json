{
    "name": "fatshark-debug",
    "displayName": "Fatshark Debugger",
    "version": "1.0.0",
    "description": "Extension to debug Fatshark applications and games.",
    "license": "MIT",
    "author": {
        "url": "http://www.fatshark.se",
        "name": "Fatshark",
        "email": "contact@fatshark.se"
    },
    "keywords": [
        "fatshark",
        "stingray",
        "debugger",
        "lua"
    ],
    "publisher": "Fatshark",
    "engines": {
        "vscode": "^1.1.5",
        "node": "^6.5.0"
    },
    "icon": "images/icon.png",
    "categories": [
        "Debuggers",
        "Languages"
    ],
    "dependencies": {
        "lodash": "^4.17.4",
        "simplified-json": "^0.2.0",
        "vscode-debugprotocol": "^1.19.0",
        "vscode-debugadapter": "^1.19.0",
        "ws": "^2.2.2"
    },
    "devDependencies": {
        "@types/es6-collections": "^0.5.29",
        "@types/es6-promise": "^0.0.32",
        "@types/mocha": "^2.2.33",
        "@types/node": "^6.0.50",
        "mocha": "^3.1.2",
        "tslint": "^5.7.0",
        "typescript": "^2.5.1",
        "vscode": "^1.1.5",
        "vscode-debugadapter-testsupport": "^1.19.0"
    },
    "scripts": {
        "prepublish": "node ./node_modules/typescript/bin/tsc -p ./src",
        "compile": "node ./node_modules/typescript/bin/tsc -p ./src",
        "tslint": "tslint ./src/**/*.ts",
        "watch": "node ./node_modules/typescript/bin/tsc -w -p ./src",
        "postinstall": "node ./node_modules/vscode/bin/install"
    },
    "main": "./out/extension",
    "activationEvents": [
        "onCommand:extension-stingray-debug.start-debug-session",
        "onCommand:extension.stingray-debug.run-command",
        "onCommand:extension.stingray-debug.getProgramName",
        "onCommand:extension.stingray-debug.provideInitialConfigurations",
        "workspaceContains:.stingray_project",
        "workspaceContains:.stingray_plugin",
        "workspaceContains:.stingray-asset-server-directory",
        "workspaceContains:spm-packages.sjson"
    ],
    "contributes": {
        "configuration": {
            "type": "object",
            "title": "Stingray configuration",
            "properties": {
                "stingray.toolchain": {
                    "type": "string",
                    "default": "${env.SR_BIN_DIR}",
                    "description": "Stingray installation folder. e.g. C:/Program Files/Autodesk/Stingray/1.8.1267.0"
                }
            }
        },
        "commands": [
            {
                "command": "extension.stingray-debug.run-command",
                "title": "Stingray Command"
            }
        ],
        "languages": [
            {
                "id": "sjson",
                "aliases": [
                    "sjson",
                    "sjson"
                ],
                "filenames": [
                    "settings.ini"
                ],
                "extensions": [
                    ".sjson",
                    ".config",
                    ".material",
                    ".shader",
                    ".shader_node",
                    ".shader_source",
                    ".render_config",
                    ".particles",
                    ".particle_editor",
                    ".bsi",
                    ".texture",
                    ".font",
                    ".unit",
                    ".unit_anim",
                    ".dcc_asset",
                    ".import_options",
                    ".physics",
                    ".landscape",
                    ".level",
                    ".timpani_bank",
                    ".timpani_master",
                    ".mouse_cursor",
                    ".surface_properties",
                    ".physics_properties",
                    ".decals",
                    ".script_flow_nodes",
                    ".flow",
                    ".flow_editor",
                    ".network_config",
                    ".strings",
                    ".volume_type",
                    ".package",
                    ".entity",
                    ".component",
                    ".type",
                    ".sound_environment",
                    ".texture_category",
                    ".stingray_project",
                    ".stingray_plugin",
                    ".stingray_layout",
                    ".plugin",
                    ".shading_environment_template",
                    ".shading_environment"
                ],
                "configuration": "./language-configuration.json"
            }
        ],
        "grammars": [
            {
                "language": "sjson",
                "scopeName": "source.sjson",
                "path": "./syntaxes/SJSON.tmLanguage"
            }
        ],
        "breakpoints": [
            {
                "language": "lua"
            }
        ],
        "debuggers": [
            {
                "type": "stingray",
                "label": "Stingray",
                "program": "./out/stingray-debugger.js",
                "runtime": "node",
                "startSessionCommand": "extension-stingray-debug.start-debug-session",
                "variables": {
                    "AskForProgramName": "extension.stingray-debug.getProgramName"
                },
                "configurationSnippets": [
                    {
                        "label": "Stingray: Application (Lua)",
                        "description": "A new configuration for launching and debugging a Stingray project.",
                        "body": {
                            "type": "stingray",
                            "request": "launch",
                            "name": "${1:My application name}",
                            "toolchain": "C:/path/to/stingray/binaries/installation",
                            "engine_exe": "interactive_win64_dev.exe",
                            "project_file": "^\"\\${workspaceRoot}/project.stingray_project\"",
                            "compile": true,
                            "additional_plugins": []
                        }
                    },
                    {
                        "label": "Stingray: Editor Engine (14000)",
                        "description": "A new configuration for debugging the Stingray editor's internal engine.",
                        "body": {
                            "type": "stingray",
                            "request": "attach",
                            "name": "${2:Stingray Editor}",
                            "ip": "127.0.0.1",
                            "port": 14000
                        }
                    },
                    {
                        "label": "Stingray: Compile (14031)",
                        "description": "A new configuration for debugging the Stingray engine running with the --compile flag.",
                        "body": {
                            "type": "stingray",
                            "request": "attach",
                            "name": "${2:Stingray Compile}",
                            "ip": "127.0.0.1",
                            "port": 14031
                        }
                    },
                    {
                        "label": "Stingray: Compile Server (14032)",
                        "description": "A new configuration for debugging the Stingray engine running as a compile server.",
                        "body": {
                            "type": "stingray",
                            "request": "attach",
                            "name": "${2:Stingray Compile Server}",
                            "ip": "127.0.0.1",
                            "port": 14032
                        }
                    }
                ],
                "configurationAttributes": {
                    "launch": {
                        "required": [
                            "toolchain",
                            "project_file"
                        ],
                        "properties": {
                            "toolchain": {
                                "type": "string",
                                "description": "Stingray installation folder. e.g. C:/Program Files/Autodesk/Stingray/1.8.1267.0"
                            },
                            "engine_exe": {
                                "type": "string",
                                "description": "Stingray executable name. e.g. stingray_win64_dev.exe"
                            },
                            "project_file": {
                                "type": "string",
                                "description": "Path to your project's *.stingray_project* file."
                            },
                            "compile": {
                                "type": "boolean",
                                "description": "Recompiles modified project files before launching the engine."
                            },
                            "command_line_args": {
                                "type": "array",
                                "description": "Optional command line arguments passed to the engine."
                            },
                        }
                    },
                    "attach": {
                        "required": [
                            "ip",
                            "port"
                        ],
                        "properties": {
                            "ip": {
                                "type": "string",
                                "description": "IP address of the device running the Stingray engine.",
                                "default": "127.0.0.1"
                            },
                            "port": {
                                "type": "number",
                                "description": "Port used by the engine for console connections.",
                                "default": 14000
                            }
                        }
                    }
                },
                "initialConfigurations": "extension.stingray-debug.provideInitialConfigurations"
            }
        ]
    }
}
